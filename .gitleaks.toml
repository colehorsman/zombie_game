# Gitleaks configuration for secret detection
# Detects hardcoded secrets, API keys, passwords in code and git history

title = "Zombie Game Security - Secret Detection"

# Custom rules for detecting secrets
[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["key", "AWS"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["key", "AWS"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey)(.{0,20})?['|"][0-9a-zA-Z]{32,45}['|"]'''
tags = ["key", "API"]

[[rules]]
id = "bearer-token"
description = "Bearer Token"
regex = '''(?i)bearer\s+[a-zA-Z0-9\-._~+/]+=*'''
tags = ["token"]

[[rules]]
id = "private-key"
description = "Private Key (RSA, DSA, EC)"
regex = '''-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----'''
tags = ["key", "private"]

[[rules]]
id = "password-assignment"
description = "Password in assignment"
regex = '''(?i)(password|passwd|pwd)\s*=\s*['"][^'"]{8,}['"]'''
tags = ["password"]

[[rules]]
id = "sonrai-token"
description = "Sonrai API Token"
regex = '''(?i)sonrai(.{0,20})?['"][a-zA-Z0-9\-._~+/]{32,}['"]'''
tags = ["token", "Sonrai"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["token", "GitHub"]

# Allowlist - files and paths to ignore
[allowlist]
description = "Allowlisted files and directories"
paths = [
    '''\.env\.example''',  # Example files are OK
    '''README\.md''',
    '''CHANGELOG\.md''',
    '''\.gitignore''',
    '''/tests/fixtures/'''  # Test fixtures with fake data
]

# Allowlist specific findings that are false positives
[[allowlist.regexes]]
description = "Ignore test passwords"
regex = '''password.*=.*['"](test|example|dummy)['"']'''

[[allowlist.regexes]]
description = "Ignore placeholder tokens"
regex = '''YOUR_.*_HERE'''
